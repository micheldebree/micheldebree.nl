(this["webpackJsonpretropixels-web"]=this["webpackJsonpretropixels-web"]||[]).push([[0],{221:function(e,t,a){},222:function(e,t,a){},250:function(e,t){},252:function(e,t){},502:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),i=a(29),r=a.n(i),o=(a(221),a(9)),s=a(530),j=a(531),l=a(205),b=a(532),d=a(527),u=a(528),h=(a(222),a(202)),O=a.n(h),m=a(529),x=a(64),f=a.n(x),g=a(525),p=a(96),v=a(203),C=a(533),S=a(535),w=a(534),I=a(1);function y(e){var t=c.a.useRef(null),a=e.width,i=e.height,r=e.imageData;return Object(n.useEffect)((function(){void 0!==r&&t.current.getContext("2d").putImageData(r,0,0)}),[r]),Object(I.jsx)(C.a,{m:1,children:Object(I.jsx)("canvas",{ref:t,width:a,height:i})})}y.defaultProps={imageData:void 0};var k=y;function D(e){var t=e.onload,a=e.imageData,c=Object(n.useState)(void 0),i=Object(o.a)(c,2),r=i[0],s=i[1],j=Object(v.a)({accept:"image/*",maxFiles:1}),l=j.acceptedFiles,b=j.fileRejections,d=j.getRootProps,u=j.getInputProps;return Object(n.useEffect)((function(){void 0!==l&&1===l.length&&function(e){var a=new FileReader;a.onabort=function(){return s("file reading was aborted")},a.onerror=function(){return s("file reading has failed")},a.onload=function(){f.a.read(a.result).then((function(a){s(void 0),t({jimpImage:a,filename:e.name})})).catch((function(e){s(e.message)}))},a.readAsArrayBuffer(e)}(l[0])}),[l]),Object(n.useEffect)((function(){if(void 0!==b&&b.length>0){var e=b[0],t=e.errors.map((function(e){return e.message})).reduce((function(e,t){return"".concat(e,",").concat(t)}));s("Cannot load ".concat(e.file.path,": ").concat(t))}}),[b]),Object(I.jsxs)(g.a,{children:[Object(I.jsx)(C.a,{border:1,m:1,boxShadow:2,borderRadius:"borderRadius",borderColor:"grey.500",children:Object(I.jsxs)("div",Object(p.a)(Object(p.a)({},d({className:"dropzone"})),{},{children:[Object(I.jsx)("input",Object(p.a)({},u())),Object(I.jsx)(k,{width:320,height:200,imageData:a}),Object(I.jsx)("p",{children:"Drop image here, or click to select image"})]}))}),Object(I.jsx)(S.a,{open:r,autoHideDuration:6e3,onClose:function(){return s(void 0)},children:Object(I.jsx)(w.a,{severity:"error",children:r})})]})}D.defaultProps={imageData:void 0};var E=D,R=a(20);function P(e){if(void 0!==e){var t,a=e.bitmap.width*e.bitmap.height*4;return t=e.bitmap.data.length>a?e.bitmap.data.slice(0,a):e.bitmap.data,void 0!==e?new ImageData(Uint8ClampedArray.from(t),e.bitmap.width,e.bitmap.height):void 0}}function z(e){var t=e.lastIndexOf("."),a=e.substring(t+1,e.length);return{basename:e.substring(0,Math.min(30,t)),extension:a}}function F(e,t){if(e.length<=t)return e;var a=z(e);return"".concat(a.basename.substring(0,t),"...").concat(a.extension)}var L=a(537),B=a(541),W=a(526),A=a(539),N=a(540);function H(e){var t=e.label,a=e.value,n=e.items,c=e.onChange;return Object(I.jsxs)(A.a,{component:"fieldset",children:[Object(I.jsx)(N.a,{component:"legend",children:t}),Object(I.jsx)(B.a,{row:!0,"aria-label":t,name:"select".concat(t),value:a,onChange:function(e){return c(e.target.value)},children:n.map((function(e){return Object(I.jsx)(W.a,{value:e,control:Object(I.jsx)(L.a,{}),label:e})}))})]})}H.defaultProps={label:"Choose"};var M=H;var G=function(e){var t=e.onChanged,a=Object(n.useState)(void 0),c=Object(o.a)(a,2),i=c[0],r=c[1],s=Object(n.useState)(void 0),j=Object(o.a)(s,2),l=j[0],b=j[1],d=Object(n.useState)(void 0),u=Object(o.a)(d,2),h=u[0],O=u[1],m=Object(n.useState)("fill"),f=Object(o.a)(m,2),p=f[0],v=f[1],C=Object(n.useState)("input"),S=Object(o.a)(C,2),w=S[0],y=S[1];return Object(n.useEffect)((function(){if(void 0!==i){var e=i.clone();"fill"===p?e.cover(320,200,x.RESIZE_HERMITE):"fit"===p?e.contain(320,200,x.RESIZE_HERMITE):function(e){var t;(e.bitmap.width<320||e.bitmap.height<200)&&(t=e.clone()),e.crop(0,0,320,200),void 0!==t&&(function(e){e.scan(0,0,e.bitmap.width,e.bitmap.height,(function(t,a,n){e.bitmap.data[n+0]=0,e.bitmap.data[n+1]=0,e.bitmap.data[n+2]=0,e.bitmap.data[n+3]=0}))}(e),e.blit(t,0,0))}(e),b(e)}}),[i,p]),Object(n.useEffect)((function(){t({jimpImage:l,filename:w}),O(P(l))}),[l,t,w]),Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("h4",{children:F(w,30)}),Object(I.jsx)(g.a,{children:Object(I.jsx)(E,{imageData:h,onload:function(e){r(e.jimpImage),y(e.filename)}})}),Object(I.jsx)(g.a,{align:"left",children:Object(I.jsx)(M,{label:"cropping",items:["crop","fill","fit"],value:p,onChange:function(e){v(e)}})})]})},T=a(538),J=a(542),Q=a(195),Z=a.n(Q),_=a(196),q=a.n(_),U=a(198),V=a.n(U),K=a(197),X=a.n(K),Y=a(91),$=a.n(Y);function ee(e){var t=e.jimpImage,a=e.onChanged,c=!0,i=!1,r=!1,s=!1,j=!1,l=Object(n.useState)(void 0),b=Object(o.a)(l,2),h=b[0],O=b[1],m=Object(n.useState)(void 0),x=Object(o.a)(m,2),f=x[0],p=x[1],v=Object(n.useState)(c),C=Object(o.a)(v,2),S=C[0],w=C[1],y=Object(n.useState)(i),D=Object(o.a)(y,2),E=D[0],R=D[1],z=Object(n.useState)(r),F=Object(o.a)(z,2),L=F[0],B=F[1],A=Object(n.useState)(s),H=Object(o.a)(A,2),M=H[0],G=H[1],Q=Object(n.useState)(j),_=Object(o.a)(Q,2),U=_[0],K=_[1],Y=Object(n.useState)(0),ee=Object(o.a)(Y,2),te=ee[0],ae=ee[1],ne=Object(n.useState)(0),ce=Object(o.a)(ne,2),ie=ce[0],re=ce[1],oe=Object(n.useState)(0),se=Object(o.a)(oe,2),je=se[0],le=se[1],be=Object(n.useState)(0),de=Object(o.a)(be,2),ue=de[0],he=de[1];Object(n.useEffect)((function(){a(h),p(P(h))}),[h,a]),Object(n.useEffect)((function(){if(void 0!==t){var e=t.clone();E&&e.greyscale(),S&&e.normalize(),e.brightness(te),e.contrast(ie),je>0&&e.blur(je),e.mirror(L,M),U&&e.invert(),ue>0&&e.threshold({max:ue,autoGreyscale:!1}),O(e)}}),[t,S,te,ie,E,je,L,M,U,ue]);var Oe=S===c&&E===i&&L===r&&M===s&&U===j&&0===ie&&0===te&&0===je&&0===ue;return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("h4",{children:"pre-processing"}),Object(I.jsx)(g.a,{children:Object(I.jsx)(k,{width:320,height:200,imageData:f})}),Object(I.jsx)(g.a,{children:Object(I.jsxs)(d.a,{variant:"contained",disabled:Oe,onClick:function(){return w(c),R(i),B(r),G(s),K(j),ae(0),re(0),le(0),void he(0)},children:[Object(I.jsx)($.a,{})," \xa0 defaults"]})}),Object(I.jsxs)(g.a,{align:"left",children:[Object(I.jsx)(W.a,{control:Object(I.jsx)(T.a,{checked:S,onChange:function(){w(!S)},name:"normalizeCheckbox"}),label:"normalize"}),Object(I.jsx)(W.a,{control:Object(I.jsx)(T.a,{checked:E,onChange:function(){R(!E)},name:"greyscaleCheckbox"}),label:"greyscale"}),Object(I.jsx)(W.a,{control:Object(I.jsx)(T.a,{checked:U,onChange:function(){K(!U)},name:"invertCheckbox"}),label:"invert"})]}),Object(I.jsxs)(g.a,{align:"left",children:[Object(I.jsx)(W.a,{control:Object(I.jsx)(T.a,{checked:L,onChange:function(){B(!L)},name:"mirrorHorCheckbox"}),label:"flip horizontal"}),Object(I.jsx)(W.a,{control:Object(I.jsx)(T.a,{checked:M,onChange:function(){G(!M)},name:"mirrorVerCheckbox"}),label:"flip vertical"}),Object(I.jsx)(N.a,{component:"legend",children:"brightness"}),Object(I.jsxs)(u.a,{container:!0,children:[Object(I.jsxs)(u.a,{item:!0,children:[Object(I.jsx)(Z.a,{})," \xa0"]}),Object(I.jsx)(u.a,{item:!0,xs:!0,children:Object(I.jsx)(J.a,{min:-1,max:1,step:.05,value:te,onChange:function(e,t){return ae(t)},valueLabelDisplay:"auto"})})]}),Object(I.jsx)(N.a,{component:"legend",children:"contrast"}),Object(I.jsxs)(u.a,{container:!0,children:[Object(I.jsxs)(u.a,{item:!0,children:[Object(I.jsx)(q.a,{})," \xa0"]}),Object(I.jsx)(u.a,{item:!0,xs:!0,children:Object(I.jsx)(J.a,{min:-1,max:1,step:.05,value:ie,onChange:function(e,t){return re(t)},valueLabelDisplay:"auto"})})]}),Object(I.jsx)(N.a,{component:"legend",children:"blur"}),Object(I.jsxs)(u.a,{container:!0,children:[Object(I.jsxs)(u.a,{item:!0,children:[Object(I.jsx)(X.a,{})," \xa0"]}),Object(I.jsx)(u.a,{item:!0,xs:!0,children:Object(I.jsx)(J.a,{min:0,max:10,value:je,onChange:function(e,t){return le(t)},valueLabelDisplay:"auto"})})]}),Object(I.jsx)(N.a,{component:"legend",children:"threshold"}),Object(I.jsxs)(u.a,{container:!0,children:[Object(I.jsxs)(u.a,{item:!0,children:[Object(I.jsx)(V.a,{})," \xa0"]}),Object(I.jsx)(u.a,{item:!0,xs:!0,children:Object(I.jsx)(J.a,{min:0,max:255,value:ue,onChange:function(e,t){return he(t)},valueLabelDisplay:"auto"})})]})]})]})}ee.defaultProps={jimpImage:void 0};var te=ee,ae=a(201),ne=a.n(ae),ce=a(200),ie=a.n(ce),re=a(199),oe=a(56),se=a.n(oe);function je(e){var t=R.GraphicModes.all.bitmap,a=e.jimpImage,c=e.onChanged,i=e.hires,r=e.colorspaceId,s=e.paletteId,j=e.ditherId,l=e.ditherRadius,b=new R.Quantizer(R.Palettes.all[s],R.ColorSpaces.all[r]),d=new R.Converter(b),u=new se.a(se.a.presets[j],l),h=Object(n.useState)(void 0),O=Object(o.a)(h,2),m=O[0],x=O[1],f=Object(n.useState)(void 0),g=Object(o.a)(f,2),p=g[0],v=g[1],C=Object(n.useState)(b),S=Object(o.a)(C,2),w=S[0],y=S[1],D=Object(n.useState)(d),E=Object(o.a)(D,2),P=E[0],z=E[1],F=Object(n.useState)(u),L=Object(o.a)(F,2),B=L[0],W=L[1];return Object(n.useEffect)((function(){y(new R.Quantizer(R.Palettes.all[s],R.ColorSpaces.all[r]))}),[r,s]),Object(n.useEffect)((function(){z(new R.Converter(w))}),[w]),Object(n.useEffect)((function(){W(new se.a(se.a.presets[j],l))}),[j,l]),Object(n.useEffect)((function(){if(void 0!==a){var e=t({hires:i}),n=a.clone();n.resize(e.mode.width,e.mode.height),"none"!==j&&B.dither(n.bitmap),n.opaque(),P.convert(n.bitmap,e),x(e)}}),[a,P,B,i,t]),Object(n.useEffect)((function(){v(function(e){if(void 0===e)return new ImageData(1,1);for(var t=e.mode.width*e.mode.pixelWidth,a=new ImageData(t,e.mode.height),n=0;n<e.mode.height;n++)for(var c=0;c<e.mode.width;c++)for(var i=e.peek(c,n),r=void 0!==i?R.Palettes.all.colodore.get(i):[0,0,0,0],o=0;o<e.mode.pixelWidth;o++){var s=4*n*t+c*e.mode.pixelWidth*4+4*o;a.data[s]=r[0],a.data[s+1]=r[1],a.data[s+2]=r[2],a.data[s+3]=255}return a}(m)),c(m)}),[m,c]),Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(k,{width:320,height:200,imageData:p})})}je.defaultProps={jimpImage:void 0,onChanged:function(){},hires:!1,colorspaceId:"xyz",paletteId:"colodore",ditherId:"bayer4x4",ditherRadius:32};var le=je;function be(e){var t="bayer4x4",a="colodore",c="xyz",i=!1,r=e.jimpImage,s=e.filename,j=Object(n.useState)(void 0),l=Object(o.a)(j,2),b=l[0],h=l[1],O=Object(n.useState)(c),m=Object(o.a)(O,2),x=m[0],f=m[1],p=Object(n.useState)(a),v=Object(o.a)(p,2),C=v[0],S=v[1],w=Object(n.useState)(i),y=Object(o.a)(w,2),k=y[0],D=y[1],E=Object(n.useState)(t),P=Object(o.a)(E,2),F=P[0],L=P[1],B=Object(n.useState)(32),A=Object(o.a)(B,2),H=A[0],G=A[1],Q="output";if(void 0!==b){var Z=1===b.mode.pixelWidth?".art":".kla",_=z(s);Q="".concat(_.basename.substring(0,30)).concat(Z)}var q="output";void 0!==b&&(q=1===b.mode.pixelWidth?"art studio file":"koala painter file");var U=x===c&&C===a&&k===i&&F===t&&32===H;return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("h4",{children:q}),Object(I.jsx)(g.a,{children:Object(I.jsx)(le,{jimpImage:r,onChanged:function(e){h(e)},hires:k,colorspaceId:x,paletteId:C,ditherId:F,ditherRadius:H})}),Object(I.jsx)(g.a,{children:Object(I.jsxs)(u.a,{container:!0,children:[Object(I.jsx)(u.a,{item:!0,xs:!0,children:Object(I.jsxs)(d.a,{variant:"contained",disabled:U,onClick:function(){return f(c),S(a),D(i),L(t),void G(32)},children:[Object(I.jsx)($.a,{})," \xa0 defaults"]})}),Object(I.jsx)(u.a,{item:!0,xs:!0,children:Object(I.jsxs)(d.a,{variant:"contained",disabled:void 0===b,color:"primary",onClick:function(){return function(){var e=R.C64Writer.toBinary(b),t=R.C64Writer.toBuffer(e),a=new Blob([t],{type:"application/octet-stream"});Object(re.saveAs)(a,Q)}()},children:[Object(I.jsx)(ie.a,{})," \xa0 Download"]})})]})}),Object(I.jsx)(g.a,{align:"left",children:Object(I.jsx)(W.a,{control:Object(I.jsx)(T.a,{checked:k,onChange:function(){D(!k)},name:"mirrorHorCheckbox"}),label:"hires"})}),Object(I.jsxs)(g.a,{align:"left",children:[Object(I.jsx)(M,{label:"colorspace",value:x,items:["rgb","yuv","xyz","rainbow"],onChange:function(e){return f(e)}}),Object(I.jsx)(M,{label:"palette",value:C,items:["colodore","pepto","deekay"],onChange:function(e){return S(e)}}),Object(I.jsx)(M,{label:"dithering",value:F,items:["none","bayer2x2","bayer4x4","bayer8x8"],onChange:function(e){return L(e)}}),Object(I.jsx)(N.a,{component:"legend",children:"dithering strength"}),Object(I.jsxs)(u.a,{container:!0,children:[Object(I.jsxs)(u.a,{item:!0,children:[Object(I.jsx)(ne.a,{})," \xa0"]}),Object(I.jsx)(u.a,{item:!0,xs:!0,children:Object(I.jsx)(J.a,{disabled:"none"===F,min:0,max:64,value:H,onChange:function(e,t){return G(t)},valueLabelDisplay:"auto"})})]})]})]})}be.defaultProps={jimpImage:void 0,filename:"output"};var de=be,ue=a.p+"static/media/logo.42e2fcaf.svg",he="2021-05-25.394080b",Oe="https://github.com/micheldebree/retropixels/commit/394080b7e902c510bc710fec96e944945051a748",me=Object(m.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));var xe=function(){var e=Object(n.useState)(void 0),t=Object(o.a)(e,2),a=t[0],c=t[1],i=Object(n.useState)(void 0),r=Object(o.a)(i,2),h=r[0],m=r[1],x=Object(n.useState)(void 0),f=Object(o.a)(x,2),g=f[0],p=f[1],v=me();return Object(I.jsx)("div",{className:"App",children:Object(I.jsxs)("body",{className:"App-body",children:[Object(I.jsx)("div",{className:v.root,children:Object(I.jsx)(s.a,{position:"static",children:Object(I.jsxs)(j.a,{variant:"dense",children:[Object(I.jsx)("img",{src:ue,alt:"Logo",className:"logo"}),Object(I.jsx)(l.a,{variant:"h6",className:v.title,align:"left",children:"Retropixels"}),Object(I.jsxs)(b.a,{href:Oe,color:"inherit",variant:"body2",children:["v",he]}),Object(I.jsx)(d.a,{color:"inherit",href:"https://github.com/micheldebree/retropixels",children:Object(I.jsx)(O.a,{})})]})})}),Object(I.jsxs)(u.a,{container:!0,spacing:3,children:[Object(I.jsx)(u.a,{item:!0,xs:!0,children:Object(I.jsx)(G,{onChanged:function(e){c(e.jimpImage),p(e.filename)}})}),Object(I.jsx)(u.a,{item:!0,xs:!0,children:Object(I.jsx)(te,{jimpImage:a,onChanged:function(e){return m(e)}})}),Object(I.jsx)(u.a,{item:!0,xs:!0,children:Object(I.jsx)(de,{jimpImage:h,filename:g})})]})]})})},fe=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,543)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,i=t.getLCP,r=t.getTTFB;a(e),n(e),c(e),i(e),r(e)}))};r.a.render(Object(I.jsx)(c.a.StrictMode,{children:Object(I.jsx)(xe,{})}),document.getElementById("root")),fe()}},[[502,1,2]]]);
//# sourceMappingURL=main.a6a897ca.chunk.js.map